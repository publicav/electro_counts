$(function(){var g=$("#menu");var d={render:{},data:"",url:"",type:"",init:function(j,h,k,i){if(k===void 0){k=""}if(i===void 0){i="post"}this.data=k;this.render=j;this.url=h;this.type=i},reqest:function(){var i=this;var h=this;$.ajax({dataType:"json",type:h.type,url:h.url,data:h.data}).done(function(j){i.render.doRun(j.data);i.render.render()}).fail(function(j){return alert(j.responseJSON.error)})}};var e=Object.create(d);var f={dest:{},user:{},html:"",init:function(i,h){if(h===void 0){h={}}this.dest=i;this.user=h},doRun:function(k){var h="";h+="<ul>";for(var j=0;j<k.length;j++){h+='\t<li class="menu_childs1">\n                                <a id="'+k[j].id_a+'" href="'+k[j].id_a+'">'+k[j].name+"</a>\n                            </li>\n            "}h+="</ul>";this.html=h},render:function(){var h;this.dest.html(this.html);if((this.user.id!=0)&&(Object.keys(this.user).length!=0)){h='<div class="user"><div class="title_user">\u0412\u044B \u0437\u0430\u0448\u043B\u0438 \u043A\u0430\u043A:</div>'+this.user.name+" "+this.user.family+"</div>"}this.dest.find("ul").append(h)}};var a={dest:{},html:"",init:function(h){this.dest=h},doRun:function(p){var l="";var o="";var h;var n;l+='<nav id="navbar"><ul id="left-menu">';for(var m=0;m<p.length;m++){n=p[m][0];if(n.li_id!==null){o=" class="+n.li_id}else{o=""}l+="\t<li"+o+'>\n    \t\t\t<a id="'+n.id_a+'" href="'+n.id_a+'">\n    \t\t\t\t<i class="'+n.icon+'"></i>\n    \t\t\t\t'+n.name+"\n    \t\t\t</a>\n    \t\t</li>";if(p[m].length>1){var k=1;l+='<ul class="submenu hide-submenu">';while(k<p[m].length){h=p[m][k];l+='<li>\n                            <a  id="'+h.id_a+'" href="'+h.id_a+'">\n                                <i class="'+h.icon+'"></i>\n                                '+h.name+"\n                            </a>\n                        </li>";k++}l+="</ul>"}}l+="</ul></nav>";this.html=l},render:function(){this.dest.html(this.html)}};var b=$("#loginmodal").dialog({title:"Регистрация пользователя",autoOpen:false,resizable:false,modal:true,height:250,width:400});var c={mMenuTarget:"",lMenuTarget:"",init:function(i,h){this.mMenuTarget=i;this.lMenuTarget=h},logout:function(){var h=this;$.ajax({dataType:"json",type:"post",url:"ajax/unregistration/"}).done(function(){f.init(h.mMenuTarget);d.init(f,"json/menu.json");d.reqest();h.lMenuTarget.html("");$("#right").html("")}).fail(function(){return alert("Error")})},login:function(i){var l=this;var j=$(i).attr("method");var h=$(i).attr("action");var k=$(i).serialize();$.ajax({dataType:"json",type:j,url:h,data:k}).done(function(m){f.init(l.mMenuTarget,m);d.init(f,"json/menu_registration.json");d.reqest();a.init(l.lMenuTarget);e.init(a,"ajax/menuleft/");e.reqest()}).fail(function(m){return alert(m.responseJSON.error)})}};$("#loginform").submit(function(h){h.preventDefault();c.login(this);b.dialog("close")});g.on("click","#logout",function(h){c.logout();h.preventDefault()});g.on("click","#login",function(h){b.dialog("open");h.preventDefault()});c.init(g,$("#left"))});