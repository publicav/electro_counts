$(function(){var f=$("#right");var b={render:{},data:"",url:"",type:"",init:function(i,g,j,h){if(j===void 0){j=""}if(h===void 0){h="post"}this.data=j;this.render=i;this.url=g;this.type=h},reqest:function(){var h=this;var g=this;$.ajax({dataType:"json",type:g.type,url:g.url,data:g.data}).done(function(i){console.log(i);h.render.doRun(i.data);h.render.render()}).fail(function(i){return alert(i.responseJSON.error)})}};var a=Object.create(b);var e={dest:{},html:"",init:function(g){this.dest=g},doRun:function(k){var h='<div id="group-counter" class="widget">';h+='<label for="group">Выбор группы счётчиков</label>';h+='<select id="group" name="group" class="ui-group-counter">';for(var j=0;j<k.length;j++){var g=k[j];h+='<option value="'+g.id+'">'+g.name+"</option>"}h+="</select>";h+="</div>";this.html=h},render:function(){this.dest.find("#group-counter").remove();this.dest.find("#btn-action-group").remove();this.dest.append(this.html);this.dest.append('<div id="btn-action-create-group" class="widget">\n                    <button id="create-count-group"><i class="fa fa-object-group"></i>\u0421\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0433\u0440\u0443\u043F\u043F\u0443</button>\n                </div>');$("#create-count-group").click(function(i){console.log("Create count group");var j={};j.id_group=$("#group").val();var h="";$("#counter-plus").find("li").each(function(l,m){if(l!=0){h+=","}h+=$(m).attr("id").substring(2)});j.group_plus=h;var k="";$("#counter-minus").find("li").each(function(l,m){if(l!=0){k+=","}k+=$(m).attr("id").substring(2)});j.group_minus=k;console.log(j);c.init(j);c.doCreateGroup();i.preventDefault()});var g={id_group:$("#group").val()};d.init(f);a.init(d,"ajax/getcounter_all/",g,"get");a.reqest();$("#group-counter").change(function(h){var i={id_group:$("#group").val()};d.init(f);a.init(d,"ajax/getcounter_all/",i,"get");a.reqest();h.preventDefault()});$("#group").select2()}};var d={dest:{},html:"",init:function(g){this.dest=g},doRun:function(n){var h=n.counter_free;var j=n.counter_plus;var l=n.counter_minus;var k=' <div id="list-counter">\n                        <div class="title-counter"><div class="title-all">\u042F\u0447\u0435\u0439\u043A\u0438</div><div class="title-plus">\u042F\u0447\u0435\u0439\u043A\u0438 \u0440\u0430\u0441\u0445\u043E\u0434</div><div class="title-minus">\u042F\u0447\u0435\u0439\u043A\u0438 \u0442\u0440\u0430\u043D\u0437\u0438\u0442</div></div>\n                            <div id="counter">\n                                <ul class="ui-counter">';for(var m=0;m<h.length;m++){var g=h[m];k+='<li id="g-'+g.id+'" class="counter-list"><span>'+g.name+"</span></li>"}k+='    </ul>\n                    </div>\n                    \n                    <div id="counter-plus">\n                        <ul class="ui-counter">';for(var m=0;m<j.length;m++){var g=j[m];k+='<li id="g-'+g.id+'" class="counter-list"><span>'+g.name+"</span></li>"}k+='</ul>\n                    </div>\n                    \n                    <div id="counter-minus">\n                        <ul class="ui-counter">';for(var m=0;m<l.length;m++){var g=l[m];k+='<li id="g-'+g.id+'" class="counter-list"><span>'+g.name+"</span></li>"}k+="       </ul>\n                        </div>\n                    </div>\n                    ";this.html=k},render:function(){this.dest.find("#list-counter").remove();this.dest.append(this.html);$("ul.ui-counter").sortable({connectWith:"ul"})}};var c={params:{},init:function(g){this.params=g},doCreateGroup:function(){$.ajax({dataType:"json",type:"post",url:"ajax/actionbtn_groupcount_create/",data:this.params}).done(function(){}).fail(function(g){return alert(g.responseJSON.error)})}};e.init(f);b.init(e,"ajax/getgroup_all/","","get");b.reqest();$(".widget button").button()});